# predictor-of-next-word-rnn-v2
Задание к зачету по дисциплине "Программирование нейронных сетей"

Google Collab с экспериментами по обучению модели (с разделением на train, validation, test датасеты; с оценкой MSE): https://colab.research.google.com/drive/1zGX1zs4DOT9SjE96ym75wi-Ll9blj675?usp=sharing

### Источники:
Проект разработан по мотивам кода Ф. Шолле "Глубокое обучение на Python. Второе издание", Главы 10. Глубокое обучение на временных последовательностях и дополнительно Глава 11. Глубокое обучение для текста.

### Для чего нужен проект
Код позволяет создать и обучить простую рекуррентную нейросеть для прогнозирования следующего слова в последовательности слов, заданных пользователем.

## Структура репозитория
Структура:
<pre><code>
requirements.txt
predictor.py
app.py
templates -> 
            index.html
povesti-belkina.txt
Sholle-Chapter10-Deep learning-of-time-sequences.py
</code></pre>

Описание файлов:

1. requirements.txt — содержит список библиотек и их версий, которые необходимы для работы вашего проекта. Он используется для управления зависимостями и обеспечения совместимости версий библиотек.
2. predictor.py — обработка и токенизация текстовых данных для обучения модели; создание модели, компиляция и обучение модели.
3. app.py — создание веб-приложения для взаимодействия пользователя с моделью; функция для предсказания следующего слова на основе обученной модели.
4. Папка "templates" -> index.html — простая веб-страницу для взаимодействия с моделью предсказания следующего слова.
5. povesti-belkina.txt — пример входных данных, на которых обучалась наша модель.
6. Sholle-Chapter10-Deep learning-of-time-sequences.py — код в формате конспекта Ф. Шолле "Глубокое обучение на Python. Второе издание", Главы 10. Глубокое обучение на временных последовательностях

### О текущей реализации
Наша модель обучена на данных всех текстов из художественного цикла А. Пушкина "Повести Белкина". Модель способна предсказывать следующее слово в заданной цепочке. 

**Наши входные данные:**

6918 токенов\
Shape of X: (19552, 100)\
Shape of y: (19552, 6918)

## ПОШАГОВАЯ ИНСТРУКЦИЯ
Рассказываем, как запустить проект.

### Шаг 1.
Изучите документацию проекта и описание файлов. Скачайте проект на локальный компьютер.

### Шаг 2.
Ориентируясь на файл requirements.txt, установите все необходимые библиотеки.
### Шаг 3.
Запустите виртуальную среду для выполнения кода. Назовите её venv. Поместите скачанные файлы внутрь вашей виртуальной среды. Должна получиться следующая структура:

<pre><code>
venv
  predictor.py
  app.py
  templates
    index.html
povesti-belkina.txt
</code></pre>

### Шаг 4.
Запустите код в файле predictor.py. Вы обучите и сохраните RNN для предсказания следующего слова.

> !!!!ВАЖНО: чтобы обучить нейросеть, замените строку C:/Users/v-lozhkina/Desktop/Lozhkina-RNN/venv/povesti-belkina.txt на ваши данные для обучения

### Шаг 5.
Запустите код в файле app.py. Перейдите по адресу 127.0.0.1:5000.

Вы создадите веб-страницу с полем ввода и кнопкой "Предсказать". Вы можете менять вид страницы в файле index.html.

### Шаг 6.
* Введите в поле ввода последовательность слов, для которой нужно предсказать следующее слово.
* Нажмите кнопку "Предсказать".
* Модель вернет спрогнозированное слово.

## О ПОДГОТОВКЕ И ОГРАНИЧЕНИЯХ

### Входные данные
Подавайте на вход txt.-файл. Специальной подготовки текст не требует. Код работает с пробелами, переносами и знаками препинания, прописными буквами. Затем токенизирует слова. Ниже приводим некоторые полезные приемы для контроля результата обработки данных.

Узнать кол-во токенов/слов:
<pre><code>
total_words = len(tokenizer.word_index) + 1
total_words
</code></pre>

Узнать присвоенные индексы словам:
<pre><code>
tokenizer.word_index
</code></pre>

### Возможные ограничения

1. Модель может ошибаться в предсказании последующего слова. Это связано с глубиной обучения модели. Чтобы оптимизировать модель, измените значение **epoch** в этапе обучения модели. Будьте внимательны — переобученная модель также может ошибаться, оптимальный вариант для данных среднего объема — 100 эпох. Однако данный вариант потребует дополнительных ресурсов и времени.
2. Обученная модель будет способна предсказывать слова только на основе данных для обучения. Если заданная последовательность не знакома модели, результата не будет. Стоит тщательно подбирать данные для обучения, исходя из ваших целей.

### Как создать виртуальное окружение
1. Установите Python, если он ещё не установлен на вашем компьютере. Установите virtualenv или любой другой инструмент для создания виртуальных окружений.
2. Откройте командную строку или терминал.
3. Перейдите в папку, где вы хотите создать виртуальное окружение.
4. Введите команду для создания виртуального окружения. Например, если вы используете virtualenv, команда будет выглядеть так: virtualenv venv, где venv — это имя вашего виртуального окружения.
5. Активируйте виртуальное окружение, введя команду source venv/bin/activate (если вы используете Linux или macOS) или .\venv\Scripts\activate (если вы используете Windows).
6. Теперь вы находитесь в виртуальном окружении. Здесь вы можете устанавливать пакеты и библиотеки, которые будут использоваться только в этом окружении.
7. Чтобы использовать виртуальное окружение в VS Code, откройте папку с вашим проектом в VS Code. В левом нижнем углу VS Code вы увидите значок Python. Нажмите на него и выберите «Python: Select Interpreter». В открывшемся окне выберите ваше виртуальное окружение из списка доступных интерпретаторов.
